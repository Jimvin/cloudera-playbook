{
    "refName" : "KAFKA-1",
    "serviceType" : "KAFKA",
    "serviceConfigs" : [ {
      "name" : "default.replication.factor",
      "value" : "1"
    }, {
      "name" : "zookeeper.chroot",
      "value" : "/kafka"
    }, {
      "name" : "sentry.kafka.caching.ttl.ms",
      "value" : "1"
    }, {
      "name" : "sentry_service",
      "value" : "SENTRY-1"
    }, {
      "name": "kerberos.auth.enable",
      {% if (krb5_kdc_type == 'ad') or (krb5_kdc_type == 'mit') %}
      "value": "true"
      {% else %}
      "value": "false"
      {% endif %}
    }, {
      "name" : "zookeeper_service",
      "ref" : "ZOOKEEPER-1"
    } ],
    "roleConfigGroups" : [ {
      "refName" : "KAFKA-1-GATEWAY-BASE",
      "roleType" : "GATEWAY",
      "base" : true
    }, {
      "refName" : "KAFKA-1-KAFKA_BROKER-BASE",
      "roleType" : "KAFKA_BROKER",
      "configs" : [ {
        "name" : "log.retention.ms",
        "variable" : "KAFKA_LOG_RETENTION"
      }
      {% if (cdh_tls) %}
       , {
        "name" : "ssl_client_truststore_location",
        "value" : "{{ tls.truststore_path }}"
      }, {
        "name" : "ssl_client_truststore_password",
        "value" : "{{ tls.truststore_password }}"
      }, {
        "name" : "ssl_enabled",
        "value" : "true"
      }, {
        "name" : "ssl_server_keystore_location",
        "value" : "{{ tls.keystore_path }}"
      }, {
        "name" : "ssl_server_keystore_password",
        "value" : "{{ tls.keystore_password }}"
      }
      {% endif %}
      , {
        "name" : "kafka.properties_role_safety_valve",
        "value" : "offsets.retention.minutes=40320\nsasl.kerberos.principal.to.local.rules={% for trusted_realm in trusted_realms %}RULE:[1:$1@$0](.*@{{ trusted_realm|upper }})s/@{{ trusted_realm|upper }}// , RULE:[2:$1@$0](.*@{{ trusted_realm|upper }})s/@{{ trusted_realm|upper }}{% endfor %}//,DEFAULT"
      }, {
        "name" : "log.dirs",
        "variable" : "KAFKA_DATA_LOG_DIRS"
      }, {
        "name" : "super.users",
        "value" : "kafka"
      } ],
      "base" : true
    } ]
  }
